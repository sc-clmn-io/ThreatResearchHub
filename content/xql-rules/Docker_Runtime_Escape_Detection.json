{
  "rule_id": 200,
  "name": "Docker Runtime Escape - Container Breakout Attempt",
  "severity": "SEV_010_CRITICAL",
  "xql_query": "//MITRE ATT&CK TTP ID: T1611 - Escape to Host\n//Data Source Requirements: XDR Agent on Linux container hosts, Docker daemon syslog forwarding\nconfig case_sensitive = false | dataset = xdr_data | filter event_type = ENUM.PROCESS and agent_os_type = ENUM.AGENT_OS_LINUX | filter (action_process_image_name in (\"docker\", \"containerd\", \"runc\", \"ctr\") and action_process_command_line contains \"--privileged\") or (action_process_command_line contains \"/proc/self/exe\" and action_process_command_line contains \"nsenter\") or (action_process_command_line contains \"mount\" and action_process_command_line contains \"/host\") or (action_process_command_line contains \"chroot\" and action_process_command_line contains \"/host\") or (action_process_image_path contains \"/var/lib/docker\" and action_process_command_line contains \"../../../\") | fields _time, agent_hostname, action_process_image_name, action_process_command_line, actor_effective_username, action_local_ip, action_remote_ip, causality_actor_process_command_line",
  "is_enabled": true,
  "description": "Detects Docker container runtime escape attempts including privileged container abuse, namespace manipulation, and host filesystem breakout techniques commonly used by attackers to escape container isolation.",
  "alert_name": "Docker Runtime Escape - Container Breakout Attempt",
  "alert_category": "EXPLOIT",
  "alert_type": null,
  "alert_description": "Critical container security violation: Attempted escape from Docker container to host system detected. This indicates potential container breakout attack targeting host system compromise.",
  "alert_domain": "DOMAIN_HUNTING",
  "alert_fields": {},
  "execution_mode": "SCHEDULED",
  "search_window": "1 hours",
  "simple_schedule": "15 minutes",
  "timezone": "UTC",
  "crontab": "*/15 * * * *",
  "suppression_enabled": true,
  "suppression_duration": "30 minutes",
  "suppression_fields": ["agent_hostname", "action_process_image_name"],
  "dataset": "alerts",
  "user_defined_severity": null,
  "user_defined_category": null,
  "mitre_defs": {
    "technique": "T1611",
    "tactic": "Escape to Host",
    "description": "Adversaries may break out of a container to gain access to the underlying host"
  },
  "investigation_query_link": "config case_sensitive = false | dataset = xdr_data | filter event_type = ENUM.PROCESS and agent_os_type = ENUM.AGENT_OS_LINUX | filter (action_process_image_name in (\"docker\", \"containerd\", \"runc\", \"ctr\") and action_process_command_line contains \"--privileged\") or (action_process_command_line contains \"/proc/self/exe\" and action_process_command_line contains \"nsenter\") or (action_process_command_line contains \"mount\" and action_process_command_line contains \"/host\") or (action_process_command_line contains \"chroot\" and action_process_command_line contains \"/host\") or (action_process_image_path contains \"/var/lib/docker\" and action_process_command_line contains \"../../../\") | fields _time, agent_hostname, action_process_image_name, action_process_command_line, actor_effective_username, action_local_ip, action_remote_ip, causality_actor_process_command_line, action_file_path, action_registry_key_name",
  "drilldown_query_timeframe": "ALERT",
  "mapping_strategy": "AUTO",
  "action": "ALERTS",
  "lookup_mapping": []
}