{"dashboards_data": [{"name": "JC - Azure AD -  Sign-in Dashboard", "description": null, "status": "ENABLED", "layout": [{"id": "row-5785", "data": [{"key": "xql_1732384550540", "data": {"type": "Custom XQL", "width": 100, "height": 424, "phrase": "dataset = msft_azure_ad_raw\n| bin _time span = 1h\n| sort asc _time\n| comp count() as signin by _time\n| limit 100\n\n\n\n\n| view graph type = line show_callouts = `true` xaxis = _time yaxis = signin default_limit = `false` seriescolor(\"signin\",\"#fa592d\") xaxistitle = \"Timestamp\" yaxistitle = \"Sign-in\" ", "time_frame": {"relativeTime": 604800000}, "viewOptions": {"type": "line", "commands": [{"command": {"op": "=", "name": "show_callouts", "value": "true"}}, {"command": {"op": "=", "name": "xaxis", "value": "_time"}}, {"command": {"op": "=", "name": "yaxis", "value": "signin"}}, {"command": {"op": "=", "name": "default_limit", "value": "false"}}, {"func": {"args": ["signin", "#fa592d"], "name": "seriescolor"}}, {"command": {"op": "=", "name": "xaxistitle", "value": "\"Timestamp\""}}, {"command": {"op": "=", "name": "yaxistitle", "value": "\"Sign-in\""}}]}}}]}, {"id": "row-4372", "data": [{"key": "xql_1750732225127", "data": {"type": "Custom XQL", "width": 100, "height": 400, "phrase": "config case_sensitive = false\n| dataset = msft_azure_ad_raw \n| filter riskState = \"AtRisk\"\n| alter errorCode = json_extract_scalar(status, \"$.errorCode\")\n| alter failureReason = json_extract_scalar(status, \"$.failureReason\")\n| alter country = json_extract_scalar(location, \"$.countryOrRegion\")\n| alter country = if(Country = \"\", \"Unknown Coutry\", Country)\n| alter state = json_extract_scalar(location, \"$.state\")\n| alter state = if(state  = \"\", \"Unknown State\", state )\n| alter city = json_extract_scalar(location, \"$.city\")\n| alter city = if(city = \"\", \"Unknown City\", city)\n| alter Location = concat(city, \", \", state, \" \", country)\n| alter browser = json_extract_scalar(deviceDetail, \"$.browser\")\n| alter operatingSystem = json_extract_scalar(deviceDetail, \"$.operatingSystem\")\n| fields _time, riskState, riskEventTypes, userDisplayName, userPrincipalName, ipAddress, errorCode, failureReason, location, browser, operatingSystem, appDisplayName\n| sort desc _time", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "table", "commands": []}, "gridRawStorageInfo": {"sort": null, "coldefs": {}, "rowHeight": "{\"rowHeight\":\"stretch\",\"gridRowsHeight\":\"high-row\"}", "columnWidth": null}}}]}, {"id": "row-4660", "data": [{"key": "xql_1732384923663", "data": {"type": "Custom XQL", "width": 50, "height": 424, "phrase": "dataset = msft_azure_ad_raw\n| alter country = json_extract_scalar(location, \"$.countryOrRegion\")\n| alter country = if(Country = \"\", \"Unknown Coutry\", Country)\n| alter state = json_extract_scalar(location, \"$.state\")\n| alter state = if(state = \"\", \"Unknown State\", state)\n| alter city = json_extract_scalar(location, \"$.city\")\n| alter city = if(city = \"\", \"Unknown City\", city)\n| comp count() as Qty by country, state, city\n| sort desc Qty\n| limit 50", "entityType": "xql-widget-table-6b45d20d-22b3-4ace-8c3f-ab9f78a35222", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "table", "commands": []}, "gridRawStorageInfo": {"sort": null, "coldefs": {}, "rowHeight": "{\"rowHeight\":\"regular\",\"gridRowsHeight\":\"medium-row\"}", "columnWidth": null}}}, {"key": "xql_1738332665195", "data": {"type": "Custom XQL", "width": 50, "height": 424, "phrase": "dataset = msft_azure_ad_raw\n| alter country = json_extract_scalar(location, \"$.countryOrRegion\")\n| alter country = if(Country = \"\", \"Unknown Country\", Country)\n| alter city = json_extract_scalar(location, \"$.city\")\n| alter city = if(city = \"\", \"Unknown City\", city)\n| alter result = json_extract_scalar(status, \"$.errorCode\")\n| filter country in (\"NG\", \"DZ\", \"AO\", \"GQ\", \"IR\", \"IQ\", \"KW\", \"LY\", \"SA\", \"AE\", \"VE\")\n\n| filter result = \"0\"\n| fields userPrincipalName  , city, country, result, clientAppUsed , appDisplayName , ipAddress , userDisplayName , networkLocationDetails , ipAddress \n\n| join type = left ( dataset = pan_dss_raw \n    | filter type = \"user\" \n    | fields upn, sam_account_name, ou, domain_name , manager_sam_account_name , department, member_of , company_name, sam_account_name , security_groups , aad_roles, email \n    ) as ad userPrincipalName  contains ad.upn \n\n| comp count() as Qty by country, city, ipAddress, userDisplayName, email \n| sort desc Qty\n| limit 50\n", "entityType": "xql-widget-table-fed4d6a9-6f15-40af-90c6-902dc80dcb17", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "table", "commands": []}, "gridRawStorageInfo": {"sort": null, "coldefs": {}, "rowHeight": "{\"rowHeight\":\"regular\",\"gridRowsHeight\":\"medium-row\"}", "columnWidth": null}}}]}, {"id": "row-3616", "data": [{"key": "xql_1732384501611", "data": {"type": "Custom XQL", "width": 50, "height": 400, "phrase": "dataset = msft_azure_ad_raw\n| alter operatingSystem = json_extract_scalar(deviceDetail , \"$.operatingSystem\")\n| alter operatingSystem = if(operatingSystem = \"\", \"N/A OS\", operatingSystem)\n| alter browser = json_extract_scalar(deviceDetail , \"$.browser\")\n| alter browser = if(browser = \"\", \"N/A Browser\", browser)\n| alter operatingSystem = concat(operatingSystem, \" - \", browser)\n| comp count() as qty by operatingSystem \n| sort desc qty\n\n\n\n\n\n\n| view graph type = pie xaxis = operatingSystem yaxis = qty ", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "pie", "commands": [{"command": {"op": "=", "name": "xaxis", "value": "operatingSystem"}}, {"command": {"op": "=", "name": "yaxis", "value": "qty"}}]}}}, {"key": "xql_1732384767628", "data": {"type": "Custom XQL", "width": 50, "height": 400, "phrase": "dataset = msft_azure_ad_raw\n| alter errorCode = json_extract_scalar(status, \"$.errorCode\")\n| filter errorCode in(\"50058\",\"50140\", \"51006\", \"50059\", \"65001\", \"52004\", \"50055\", \"50144\",\"50072\", \"50074\", \"16000\",\"16001\", \"16003\", \"50127\", \"50125\", \"50129\",\"50143\", \"81010\", \"81014\", \"81012\")\n| alter failureReason = json_extract_scalar(status, \"$.failureReason\")\n| comp count() as qty by errorCode, failureReason\n| sort desc qty\n", "entityType": "xql-widget-table-80cbaa22-77e6-46eb-8dbd-cbf83269d127", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "table", "commands": []}, "gridRawStorageInfo": {"sort": null, "coldefs": {}, "rowHeight": "{\"rowHeight\":\"regular\",\"gridRowsHeight\":\"medium-row\"}", "columnWidth": null}}}]}, {"id": "row-1512", "data": [{"key": "xql_1750732757792", "data": {"type": "Custom XQL", "width": 100, "height": 400, "phrase": "dataset = msft_azure_ad_raw\n| alter errorCode = json_extract_scalar(status, \"$.errorCode\")\n| filter errorCode != \"0\"\n| alter failureReason = json_extract_scalar(status, \"$.failureReason\")\n| alter country = json_extract_scalar(location, \"$.countryOrRegion\")\n| alter country = if(Country = \"\", \"Unknown Coutry\", Country)\n| alter state = json_extract_scalar(location, \"$.state\")\n| alter state = if(state  = \"\", \"Unknown State\", state )\n| alter city = json_extract_scalar(location, \"$.city\")\n| alter city = if(city = \"\", \"Unknown City\", city)\n| alter Location = concat(city, \", \", state, \" \", country)\n| alter browser = json_extract_scalar(deviceDetail, \"$.browser\")\n| alter operatingSystem = json_extract_scalar(deviceDetail, \"$.operatingSystem\")\n| fields _time, userDisplayName, userPrincipalName, ipAddress, errorCode, failureReason, location, browser, operatingSystem, appDisplayName\n| sort desc _time\n", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "table", "commands": []}, "gridRawStorageInfo": {"sort": null, "coldefs": {}, "rowHeight": "{\"rowHeight\":\"regular\",\"gridRowsHeight\":\"medium-row\"}", "columnWidth": null}}}]}, {"id": "row-3782", "data": [{"key": "xql_1750732891119", "data": {"type": "Custom XQL", "width": 100, "height": 400, "phrase": "dataset = msft_azure_ad_raw\n| alter errorCode = json_extract_scalar(status, \"$.errorCode\")\n| filter errorCode = \"0\"\n| alter failureReason = json_extract_scalar(status, \"$.failureReason\")\n| alter country = json_extract_scalar(location, \"$.countryOrRegion\")\n| alter country = if(Country = \"\", \"Unknown Coutry\", Country)\n| alter state = json_extract_scalar(location, \"$.state\")\n| alter state = if(state  = \"\", \"Unknown State\", state )\n| alter city = json_extract_scalar(location, \"$.city\")\n| alter city = if(city = \"\", \"Unknown City\", city)\n| alter Location = concat(city, \", \", state, \" \", country)\n| alter browser = json_extract_scalar(deviceDetail, \"$.browser\")\n| alter operatingSystem = json_extract_scalar(deviceDetail, \"$.operatingSystem\")\n| fields _time, userDisplayName, userPrincipalName, location, browser, operatingSystem, appDisplayName\n| sort desc _time", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "table", "commands": []}, "gridRawStorageInfo": {"sort": null, "coldefs": {}, "rowHeight": "{\"rowHeight\":\"regular\",\"gridRowsHeight\":\"medium-row\"}", "columnWidth": null}}}]}], "default_dashboard_id": 1, "global_id": "d6a68f4ea01f4c9e81cf852a0a0b0650", "metadata": {"params": []}}], "widgets_data": [{"widget_key": "xql_1732384501611", "title": "JC - Azure AD - Sign-in by Device", "creation_time": 1750728681998, "description": "", "data": {"phrase": "dataset = msft_azure_ad_raw\n| alter operatingSystem = json_extract_scalar(deviceDetail , \"$.operatingSystem\")\n| alter operatingSystem = if(operatingSystem = \"\", \"N/A OS\", operatingSystem)\n| alter browser = json_extract_scalar(deviceDetail , \"$.browser\")\n| alter browser = if(browser = \"\", \"N/A Browser\", browser)\n| alter operatingSystem = concat(operatingSystem, \" - \", browser)\n| comp count() as qty by operatingSystem \n| sort desc qty\n\n\n\n\n\n\n\n| view graph type = pie xaxis = operatingSystem yaxis = qty ", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "pie", "commands": [{"command": {"op": "=", "name": "xaxis", "value": "operatingSystem"}}, {"command": {"op": "=", "name": "yaxis", "value": "qty"}}]}}, "support_time_range": true, "additional_info": {"query_tables": ["msft_azure_ad_raw"], "query_uses_library": false}, "creator_mail": "scoleman@paloaltonetworks.com"}, {"widget_key": "xql_1732384550540", "title": "JC- Azure AD - Sign-in Trend over Time", "creation_time": 1750728682048, "description": "MS Entra ID Sign-in Logs - Sign-in Trend over Time", "data": {"phrase": "dataset = msft_azure_ad_raw\n| bin _time span = 1h\n| sort asc _time\n| comp count() as signin by _time\n| limit 100\n\n\n\n\n| view graph type = line show_callouts = `true` xaxis = _time yaxis = signin default_limit = `false` seriescolor(\"signin\",\"#fa592d\") xaxistitle = \"Timestamp\" yaxistitle = \"Sign-in\" ", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "line", "commands": [{"command": {"op": "=", "name": "show_callouts", "value": "true"}}, {"command": {"op": "=", "name": "xaxis", "value": "_time"}}, {"command": {"op": "=", "name": "yaxis", "value": "signin"}}, {"command": {"op": "=", "name": "default_limit", "value": "false"}}, {"func": {"args": ["signin", "#fa592d"], "name": "seriescolor"}}, {"command": {"op": "=", "name": "xaxistitle", "value": "\"Timestamp\""}}, {"command": {"op": "=", "name": "yaxistitle", "value": "\"Sign-in\""}}]}}, "support_time_range": true, "additional_info": {"query_tables": ["msft_azure_ad_raw"], "query_uses_library": false}, "creator_mail": "scoleman@paloaltonetworks.com"}, {"widget_key": "xql_1732384767628", "title": "JC - Azure AD - Summary of Sign-ins waiting on user action", "creation_time": 1750728682122, "description": "", "data": {"phrase": "dataset = msft_azure_ad_raw\n| alter errorCode = json_extract_scalar(status, \"$.errorCode\")\n| filter errorCode in(\"50058\",\"50140\", \"51006\", \"50059\", \"65001\", \"52004\", \"50055\", \"50144\",\"50072\", \"50074\", \"16000\",\"16001\", \"16003\", \"50127\", \"50125\", \"50129\",\"50143\", \"81010\", \"81014\", \"81012\")\n| alter failureReason = json_extract_scalar(status, \"$.failureReason\")\n| comp count() as qty by errorCode, failureReason\n| sort desc qty\n", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "table", "commands": []}, "gridRawStorageInfo": {"sort": null, "coldefs": {}, "rowHeight": "{\"rowHeight\":\"regular\",\"gridRowsHeight\":\"medium-row\"}", "columnWidth": null}}, "support_time_range": true, "additional_info": {"query_tables": ["msft_azure_ad_raw"], "query_uses_library": false}, "creator_mail": "scoleman@paloaltonetworks.com"}, {"widget_key": "xql_1732384923663", "title": "JC - Azure AD - Top 50 Sign-in Location", "creation_time": 1750728682206, "description": "MS Entra ID Sign-in Logs - Top 50 Sign-in Location", "data": {"phrase": "dataset = msft_azure_ad_raw\n| alter country = json_extract_scalar(location, \"$.countryOrRegion\")\n| alter country = if(Country = \"\", \"Unknown Coutry\", Country)\n| alter state = json_extract_scalar(location, \"$.state\")\n| alter state = if(state = \"\", \"Unknown State\", state)\n| alter city = json_extract_scalar(location, \"$.city\")\n| alter city = if(city = \"\", \"Unknown City\", city)\n| comp count() as Qty by country, state, city\n| sort desc Qty\n| limit 50", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "table", "commands": []}, "gridRawStorageInfo": {"sort": null, "coldefs": {}, "rowHeight": "{\"rowHeight\":\"regular\",\"gridRowsHeight\":\"medium-row\"}", "columnWidth": "\"stretch\""}}, "support_time_range": true, "additional_info": {"query_tables": ["msft_azure_ad_raw"], "query_uses_library": false}, "creator_mail": "scoleman@paloaltonetworks.com"}, {"widget_key": "xql_1738332665195", "title": "JC - Top 50 Sign-in from Unauthorized Country", "creation_time": 1750728682333, "description": "NU - Top 50 Sign-in from Unauthorized Country", "data": {"phrase": "dataset = msft_azure_ad_raw\n| alter country = json_extract_scalar(location, \"$.countryOrRegion\")\n| alter country = if(Country = \"\", \"Unknown Country\", Country)\n| alter city = json_extract_scalar(location, \"$.city\")\n| alter city = if(city = \"\", \"Unknown City\", city)\n| alter result = json_extract_scalar(status, \"$.errorCode\")\n| filter country in (\"NG\", \"DZ\", \"AO\", \"GQ\", \"IR\", \"IQ\", \"KW\", \"LY\", \"SA\", \"AE\", \"VE\")\n\n| filter result = \"0\"\n| fields userPrincipalName  , city, country, result, clientAppUsed , appDisplayName , ipAddress , userDisplayName , networkLocationDetails , ipAddress \n\n| join type = left ( dataset = pan_dss_raw \n    | filter type = \"user\" \n    | fields upn, sam_account_name, ou, domain_name , manager_sam_account_name , department, member_of , company_name, sam_account_name , security_groups , aad_roles, email \n    ) as ad userPrincipalName  contains ad.upn \n\n| comp count() as Qty by country, city, ipAddress, userDisplayName, email \n| sort desc Qty\n| limit 50\n", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "table", "commands": []}}, "support_time_range": true, "additional_info": {"query_tables": ["pan_dss_raw", "msft_azure_ad_raw"], "query_uses_library": false}, "creator_mail": "scoleman@paloaltonetworks.com"}, {"widget_key": "xql_1750732225127", "title": "JC - Azure AD - Users AtRisk", "creation_time": 1750732225127, "description": null, "data": {"phrase": "config case_sensitive = false\n| dataset = msft_azure_ad_raw \n| filter riskState = \"AtRisk\"\n| alter errorCode = json_extract_scalar(status, \"$.errorCode\")\n| alter failureReason = json_extract_scalar(status, \"$.failureReason\")\n| alter country = json_extract_scalar(location, \"$.countryOrRegion\")\n| alter country = if(Country = \"\", \"Unknown Coutry\", Country)\n| alter state = json_extract_scalar(location, \"$.state\")\n| alter state = if(state  = \"\", \"Unknown State\", state )\n| alter city = json_extract_scalar(location, \"$.city\")\n| alter city = if(city = \"\", \"Unknown City\", city)\n| alter Location = concat(city, \", \", state, \" \", country)\n| alter browser = json_extract_scalar(deviceDetail, \"$.browser\")\n| alter operatingSystem = json_extract_scalar(deviceDetail, \"$.operatingSystem\")\n| fields _time, riskState, riskEventTypes, userDisplayName, userPrincipalName, ipAddress, errorCode, failureReason, location, browser, operatingSystem, appDisplayName\n| sort desc _time", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "table", "commands": []}, "gridRawStorageInfo": {"sort": null, "coldefs": {}, "rowHeight": "{\"rowHeight\":\"stretch\",\"gridRowsHeight\":\"high-row\"}", "columnWidth": null}}, "support_time_range": true, "additional_info": {"query_tables": ["msft_azure_ad_raw"], "query_uses_library": false}, "creator_mail": "jecrawford@paloaltonetworks.com"}, {"widget_key": "xql_1750732757792", "title": "JC - Azure AD - Sign-in Errors", "creation_time": 1750732757792, "description": null, "data": {"phrase": "dataset = msft_azure_ad_raw\n| alter errorCode = json_extract_scalar(status, \"$.errorCode\")\n| filter errorCode != \"0\"\n| alter failureReason = json_extract_scalar(status, \"$.failureReason\")\n| alter country = json_extract_scalar(location, \"$.countryOrRegion\")\n| alter country = if(Country = \"\", \"Unknown Coutry\", Country)\n| alter state = json_extract_scalar(location, \"$.state\")\n| alter state = if(state  = \"\", \"Unknown State\", state )\n| alter city = json_extract_scalar(location, \"$.city\")\n| alter city = if(city = \"\", \"Unknown City\", city)\n| alter Location = concat(city, \", \", state, \" \", country)\n| alter browser = json_extract_scalar(deviceDetail, \"$.browser\")\n| alter operatingSystem = json_extract_scalar(deviceDetail, \"$.operatingSystem\")\n| fields _time, userDisplayName, userPrincipalName, ipAddress, errorCode, failureReason, location, browser, operatingSystem, appDisplayName\n| sort desc _time\n", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "table", "commands": []}, "gridRawStorageInfo": {"sort": null, "coldefs": {}, "rowHeight": "{\"rowHeight\":\"regular\",\"gridRowsHeight\":\"medium-row\"}", "columnWidth": null}}, "support_time_range": true, "additional_info": {"query_tables": ["msft_azure_ad_raw"], "query_uses_library": false}, "creator_mail": "jecrawford@paloaltonetworks.com"}, {"widget_key": "xql_1750732891119", "title": "JC - Azure AD - Sign-in Log", "creation_time": 1750732891119, "description": null, "data": {"phrase": "dataset = msft_azure_ad_raw\n| alter errorCode = json_extract_scalar(status, \"$.errorCode\")\n| filter errorCode = \"0\"\n| alter failureReason = json_extract_scalar(status, \"$.failureReason\")\n| alter country = json_extract_scalar(location, \"$.countryOrRegion\")\n| alter country = if(Country = \"\", \"Unknown Coutry\", Country)\n| alter state = json_extract_scalar(location, \"$.state\")\n| alter state = if(state  = \"\", \"Unknown State\", state )\n| alter city = json_extract_scalar(location, \"$.city\")\n| alter city = if(city = \"\", \"Unknown City\", city)\n| alter Location = concat(city, \", \", state, \" \", country)\n| alter browser = json_extract_scalar(deviceDetail, \"$.browser\")\n| alter operatingSystem = json_extract_scalar(deviceDetail, \"$.operatingSystem\")\n| fields _time, userDisplayName, userPrincipalName, location, browser, operatingSystem, appDisplayName\n| sort desc _time", "time_frame": {"relativeTime": 86400000}, "viewOptions": {"type": "table", "commands": []}, "gridRawStorageInfo": {"sort": null, "coldefs": {}, "rowHeight": "{\"rowHeight\":\"regular\",\"gridRowsHeight\":\"medium-row\"}", "columnWidth": null}}, "support_time_range": true, "additional_info": {"query_tables": ["msft_azure_ad_raw"], "query_uses_library": false}, "creator_mail": "jecrawford@paloaltonetworks.com"}]}